<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <record id="hr_expense_view_form" model="ir.ui.view">
        <field name="name">hr.expense.view.form</field>
        <field name="model">hr.expense</field>
        <field name="inherit_id" ref="hr_expense.hr_expense_view_form" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='description']" position="before">
                <notebook attrs="{'invisible': [('advance', '=', False)]}">
                    <page name="advance" string="Advance Details">
                        <field name="advance_line">
                            <tree editable="bottom">
                                <field name="name" />
                                <field name="unit_amount" sum="Total" />
                                <field name="currency_id" invisible="1" />
                            </tree>
                        </field>
                    </page>
                </notebook>
            </xpath>
        </field>
    </record>
    <record id="view_hr_expense_sheet_form" model="ir.ui.view">
        <field name="name">hr.expense.sheet.form</field>
        <field name="model">hr.expense.sheet</field>
        <field name="inherit_id" ref="hr_expense.view_hr_expense_sheet_form" />
        <field name="arch" type="xml">
            <xpath expr="//notebook/page[@name='expenses']" position="after">
                <page
                    name="advance"
                    string="Advance Details"
                    attrs="{'invisible': [('advance', '=', False), ('advance_sheet_id', '=', False)]}"
                >
                    <field name="advance_line">
                        <tree editable="bottom">
                            <field name="name" />
                            <field name="unit_amount" sum="Total" />
                            <field name="currency_id" invisible="1" />
                        </tree>
                    </field>
                </page>
                <page
                    name="clearing"
                    string="Clearing Details"
                    attrs="{'invisible': [('advance', '=', False), ('advance_sheet_id', '=', False)]}"
                >
                    <field
                        name="clearing_line"
                        nolabel="1"
                        widget="many2many"
                        context="{'form_view_ref' : 'hr_expense.hr_expense_view_form_without_header'}"
                    >
                        <tree decoration-danger="is_refused" editable="bottom">
                            <field name="date" optional="show" />
                            <field name="name" />
                            <field name="reference" optional="hide" />
                            <field
                                name="analytic_account_id"
                                optional="show"
                                groups="analytic.group_analytic_accounting"
                            />
                            <field
                                name="analytic_tag_ids"
                                optional="hide"
                                widget="many2many_tags"
                                groups="analytic.group_analytic_tags"
                            />
                            <field name="account_id" optional="hide" />
                            <field name="message_unread" invisible="1" />
                            <field name="attachment_number" string=" " />
                            <button
                                name="action_get_attachment_view"
                                string="View Attachments"
                                type="object"
                                icon="fa-paperclip"
                            />
                            <field
                                name="unit_amount"
                                optional="hide"
                                widget="monetary"
                                options="{'currency_field': 'currency_id'}"
                            />
                            <field name="currency_id" optional="hide" />
                            <field name="quantity" optional="hide" />
                            <field name="company_id" invisible="1" />
                            <field
                                name="tax_ids"
                                optional="show"
                                widget="many2many_tags"
                                groups="account.group_account_readonly"
                                context="{'default_company_id': company_id}"
                            />
                            <field
                                name="total_amount"
                                optional="show"
                                sum="Total Amount"
                            />
                            <field name="company_currency_id" invisible="1" />
                            <field
                                name="total_amount_company"
                                optional="show"
                                groups="base.group_multi_currency"
                            />
                            <field name="is_refused" invisible="1" />
                            <field
                                name="state"
                                decoration-info="state == 'draft'"
                                decoration-success="state in ['reported', 'approved', 'done']"
                                decoration-danger="state in 'refused'"
                                widget="badge"
                            />
                        </tree>
                    </field>
                </page>
            </xpath>
        </field>
    </record>
</odoo>
